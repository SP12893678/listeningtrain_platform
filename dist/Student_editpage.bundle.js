(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{727:function(t,e,a){var n=a(746);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,a(98).default)("1bd07250",n,!1,{})},744:function(t,e,a){t.exports=a.p+"assets/xlsx/帳戶名單範例.xlsx"},745:function(t,e,a){"use strict";var n=a(727);a.n(n).a},746:function(t,e,a){(e=a(97)(!1)).push([t.i,"\n.jf-title[data-v-19fc8615] {\r\n    font-size: 32px;\n}\r\n",""]),t.exports=e},758:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{attrs:{fluid:""}},[n("v-list-item",{attrs:{"two-line":""}},[n("v-list-item-content",[n("v-list-item-title",{staticClass:"jf-title pa-2"},[t._v("學生帳戶")])],1),t._v(" "),n("v-list-item-action",{staticClass:"ml-0 mb-0"},[n("v-btn",{attrs:{"data-v-step":"Student-editpage-add",text:""},on:{click:t.addOneUser}},[n("v-icon",{attrs:{left:""}},[t._v("mdi-playlist-plus")]),t._v("新增一筆\n            ")],1)],1),t._v(" "),n("v-list-item-action",{staticClass:"ml-0 mb-0"},[n("v-menu",{attrs:{rounded:"lg","offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.attrs,i=e.on;return[n("v-btn",t._g(t._b({attrs:{color:"green",text:"","data-v-step":"Student-editpage-excel"}},"v-btn",a,!1),i),[n("v-icon",[t._v("mdi-microsoft-excel")]),t._v("Excel匯入\n                    ")],1)]}}])},[t._v(" "),n("v-list",[n("v-list-item",{attrs:{link:""},on:{click:t.uploadFileClick}},[n("v-list-item-icon",{staticClass:"mr-2"},[n("v-icon",[t._v("mdi-cloud-upload")])],1),t._v(" "),n("v-list-item-title",[t._v("檔案上傳")]),t._v(" "),n("input",{ref:"uploader",attrs:{type:"file",hidden:""},on:{change:t.onFileChanged}})],1),t._v(" "),n("v-list-item",{attrs:{link:""},on:{click:function(e){t.setting.dialog=!0}}},[n("v-list-item-icon",{staticClass:"mr-2"},[n("v-icon",[t._v("mdi-cog")])],1),t._v(" "),n("v-list-item-title",[t._v("上傳設定")])],1),t._v(" "),n("v-divider"),t._v(" "),n("v-list-item",{attrs:{href:a(744),link:"",download:""}},[n("v-list-item-icon",{staticClass:"mr-2"},[n("v-icon",[t._v("mdi-download")])],1),t._v(" "),n("v-list-item-title",[t._v("下載範例")])],1)],1)],1)],1),t._v(" "),n("v-list-item-action",{staticClass:"ml-0 mb-0"},[n("v-btn",{attrs:{color:"red","data-v-step":"Student-editpage-save",text:""},on:{click:t.saveAccount}},[n("v-icon",{attrs:{left:""}},[t._v("mdi-content-save")]),t._v("儲存帳戶\n            ")],1)],1)],1),t._v(" "),n("v-divider"),t._v(" "),n("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[n("v-list-item",{staticClass:"mt-4",attrs:{"two-line":""}},[n("v-list-item-content",[n("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.user_header,items:t.users,"data-v-step":"Student-editpage-studnet-table","multi-sort":""},scopedSlots:t._u([{key:"item.name",fn:function(e){var a=e.item;return[n("v-text-field",{attrs:{rules:t.rules.counter12,clearable:""},model:{value:a.name,callback:function(e){t.$set(a,"name",e)},expression:"item.name"}})]}},{key:"item.account",fn:function(e){var a=e.item;return[n("v-text-field",{attrs:{rules:t.rules.counter12,clearable:""},model:{value:a.account,callback:function(e){t.$set(a,"account",e)},expression:"item.account"}})]}},{key:"item.password",fn:function(e){var a=e.item;return[n("v-text-field",{attrs:{rules:t.rules.counter16,"append-icon":a.pwshow?"mdi-eye":"mdi-eye-off",type:a.pwshow?"text":"password"},on:{"click:append":function(t){a.pwshow=!a.pwshow}},model:{value:a.password,callback:function(e){t.$set(a,"password",e)},expression:"item.password"}})]}},{key:"item.email",fn:function(e){var a=e.item;return[n("v-text-field",{attrs:{rules:t.rules.email,clearable:""},model:{value:a.email,callback:function(e){t.$set(a,"email",e)},expression:"item.email"}})]}},{key:"item.tags",fn:function(e){var a=e.item;return[n("v-combobox",{attrs:{label:"輸入完按Enter鍵插入",multiple:"","small-chips":""},model:{value:a.tags,callback:function(e){t.$set(a,"tags",e)},expression:"item.tags"}})]}},{key:"item.delete",fn:function(e){var a=e.item;return[n("v-btn",{attrs:{icon:""},on:{click:function(e){return t.deleteOneUser(a)}}},[n("v-icon",[t._v("mdi-delete")])],1)]}}])})],1)],1)],1),t._v(" "),n("v-dialog",{attrs:{"max-width":"800"},model:{value:t.setting.dialog,callback:function(e){t.$set(t.setting,"dialog",e)},expression:"setting.dialog"}},[n("v-card",[n("v-card-title",[t._v("上傳設定")]),t._v(" "),n("v-card-text",[n("v-switch",{attrs:{label:"Excel第一列選取"},model:{value:t.setting.firstline,callback:function(e){t.$set(t.setting,"firstline",e)},expression:"setting.firstline"}})],1)],1)],1),t._v(" "),n("v-dialog",{attrs:{"max-width":"600",persistent:""},model:{value:t.progress.dialog,callback:function(e){t.$set(t.progress,"dialog",e)},expression:"progress.dialog"}},[n("v-card",[n("v-card-title",[t._v("執行進度")]),t._v(" "),n("v-progress-linear",{attrs:{value:t.progress.value,"buffer-value":t.progress.value,color:"deep-purple accent-4",stream:"",rounded:"",height:"6"}})],1)],1),t._v(" "),n("v-tour",{attrs:{name:this.$route.name,steps:t.steps}})],1)};n._withStripped=!0;var i,s=a(6),l=a.n(s),r=a(13),o=a.n(r),c=a(16),u={data:function(){return{valid:!0,progress:{dialog:!1,value:0},search:null,file:null,setting:{dialog:!1,firstline:!0},users:[],user_header:[{text:"名稱",align:"start",value:"name"},{text:"帳號",value:"account"},{text:"密碼",value:"password",sortable:!1},{text:"信箱",value:"email"},{text:"標籤",value:"tags"},{text:"刪除",value:"delete",sortable:!1}],rules:{must:[function(t){return!!t||"必填!"}],email:[function(t){return!!t||"必填!"},function(t){return/.+@.+\..+/.test(t)||"不符合E-mail格式"},function(t){return t&&t.length<=30||"最大30個字"}],counter12:[function(t){return!!t||"必填!"},function(t){return t&&t.length<=12||"最大12個字"}],counter16:[function(t){return!!t||"必填!"},function(t){return t&&t.length<=16||"最大16個字"}]},steps:[{target:'[data-v-step="Student-editpage-studnet-table"]',header:{title:"學生帳戶編輯資料表"},content:"將列出新增的學生帳戶資料表，可於表中查看並編輯各項內容和屬性，在最右側有刪除按鈕可取消新增。",params:{enableScrolling:!1}},{target:'[data-v-step="Student-editpage-add"]',header:{title:"新增一筆資料按鈕"},content:"點選後將新增一筆空白資料的學生帳戶於資料表中。",params:{enableScrolling:!1}},{target:'[data-v-step="Student-editpage-excel"]',header:{title:"Excel匯入選單"},content:"點選後將列出選單，可透過檔案上傳按鈕匯入學生帳戶至頁面中，上傳設定按鈕可設定匯入時的運作，下載範例按鈕將下載學生帳戶範例。",params:{enableScrolling:!1}},{target:'[data-v-step="Student-editpage-save"]',header:{title:"學生帳戶儲存按鈕"},content:"編輯完學生帳戶資料後，可點選此按鈕進行儲存。",params:{enableScrolling:!1}}]}},methods:{uploadFileClick:function(){this.$refs.uploader.click()},onFileChanged:function(t){this.file=t.target.files[0],null!=this.file&&null!=this.file&&this.getExcelFileData()},getExcelFileData:(i=o()(l.a.mark((function t(e){var a,n,i=this;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(a=new FormData).append("file",this.file),n={onUploadProgress:function(t){}},Object(c.d)(a,{headers:{"Content-Type":"multipart/form-data"},params:{type:"upload_and_get_excel_data"}},n.onUploadProgress).then((function(t){var e=i;t.data.forEach((function(t,a){var n={};n.name=t.A,n.account=t.B,n.password=t.C,n.email=t.D,n.tags=t.E.split(";"),n.pwshow=!1,(e.setting.firstline&&0==a||0!=a)&&e.users.push(n)}))}));case 4:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)}),addOneUser:function(){this.users.push({name:null,account:null,password:null,email:null,tags:[],pwshow:!1})},deleteOneUser:function(t){this.users.splice(this.users.indexOf(t),1)},saveAccount:function(){!this.$refs.form.validate()||this.users.length<=0||Object(c.m)({type:"insert",items:this.users}).then((function(t){}))}}},d=(a(745),a(79)),v=Object(d.a)(u,n,[],!1,null,"19fc8615",null);v.options.__file="src/components/manage/Student-editpage.vue";e.default=v.exports}}]);